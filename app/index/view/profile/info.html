<div class="layui-card">
    <div class="layui-card-header">
        <span class="layui-icon font-s10 color-desc margin-right-5">&#xe770;</span>编辑个人信息
    </div>
    <div class="layui-card-body">
        <form class="layui-form" lay-filter="profileInfoForm">
            <div class="layui-row layui-col-space20">
                <div class="layui-col-md6">
                    <div class="layui-form-item">
                        <label class="layui-form-label">手机号</label>
                        <div class="layui-input-block">
                            <input type="text" value="{$user.phone}" readonly class="layui-input layui-disabled">
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">昵称</label>
                        <div class="layui-input-block">
                            <input type="text" name="nickname" value="{$user.nickname|default=''}" placeholder="请输入昵称" class="layui-input">
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">联系地址</label>
                        <div class="layui-input-block">
                            <input type="text" name="address" value="{$user.address|default=''}" placeholder="请输入联系地址" class="layui-input">
                        </div>
                    </div>
                </div>
                
                <div class="layui-col-md6">
                    <div class="layui-form-item">
                        <label class="layui-form-label">性别</label>
                        <div class="layui-input-block">
                            <select name="gender" lay-verify="">
                                <option value="0" {if $user.gender == 0}selected{/if}>未知</option>
                                <option value="1" {if $user.gender == 1}selected{/if}>男</option>
                                <option value="2" {if $user.gender == 2}selected{/if}>女</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">注册时间</label>
                        <div class="layui-input-block">
                            <input type="text" value="{$user.create_time}" readonly class="layui-input layui-disabled">
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">最后登录</label>
                        <div class="layui-input-block">
                            <input type="text" value="{$user.login_time|default='从未登录'}" readonly class="layui-input layui-disabled">
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">生日</label>
                        <div class="layui-input-block">
                            <input type="date" name="birthday" value="{$user.birthday|default=''}" class="layui-input">
                        </div>
                    </div>
                </div>
            </div>
            

            
            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit lay-filter="updateInfo">保存修改</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
layui.use(['form', 'layer'], function(){
    var form = layui.form
        ,layer = layui.layer;
    
    // 监听提交
    form.on('submit(updateInfo)', function(data){
        var loadIndex = layer.load(2, {shade: 0.3});
        
        $.post('{:url("updateInfo")}', data.field, function(res){
            layer.close(loadIndex);
            if(res.code === 1){
                layer.msg('保存成功', {icon: 1});
            } else {
                layer.msg(res.info || '保存失败', {icon: 2});
            }
        }, 'json').fail(function(){
            layer.close(loadIndex);
            layer.msg('网络错误，请重试', {icon: 2});
        });
        
        return false;
    });
});
</script>